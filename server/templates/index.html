{% extends "base.html" %}
{% block title %}MPO Home{% endblock %}
{% block hscripts %}{% endblock %}
{% block index_active %} class="active" {% endblock %}
{% block container %}

      <!-- Main hero unit for a primary marketing message or call to action -->
<div class="leaderboard">
	<div>
	  <span class="pull-right"><a href="search" role="button" class="btn btn-success"><i class="icon-search icon-white"></i>&nbsp;Search</a></span>
	  <h1> MPO Workflows </h1>
	</div>
    <div class="row-fluid">
    <div class="span12">
{% if results %}
<div>
<span class="muted"><small>show:</small></span>  <div class="btn-group">
    <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
    {{ rpp }}
    <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
    <li>&nbsp;<a href="{{ url_for("index", wf_name=wf_name,r=15) }}">15</a></li>
    <li>&nbsp;<a href="{{ url_for("index", wf_name=wf_name,r=30) }}">30</a></li>
    <li>&nbsp;<a href="{{ url_for("index", wf_name=wf_name,r=90) }}">90</a></li>
    </ul>
    </div>
</div>
                <table class="main">
                  <tr>
                    <th width="20%">CompositeID</th><th width="35%">Description</th><th width="12%">Creation Time</th><th width="8%">Comments</th>
                  </tr>
    {% for item in results %}
                <div id="accordion2" class="accordion">
                <tr>
                    
                    <td><a href="#">{{ item.username }}</a> / <a href="{{ url_for("index", wf_name=item.name) }}">{{ item.name }}</a> / <a href="{{ url_for("connections", wid=item.uid) }}">{{ item.comp_seq }}</a></td>
                    <td>{{ item.description }}</a></td>
                    <td class="xsmall">{{ item.time }}</td>
                    <!-- <td>{{ item.username }}</td> -->
                    <td>
                <div class="accordion-group">
                  <div class="accordion-heading">
                <a href="#commentDrop{{ item.uid }}" class="btn btn-mini btn-info" data-parent="#accordion2" data-toggle="collapse">
                  {% if item.num_comments %}
                    {{ item.num_comments }}
                  {% else %}
                    0
                  {% endif %}
                </a>
                &nbsp;<a href="#submitComment_{{ item.uid }}" class="btn btn-mini btn-success" data-parent="#accordion2" data-toggle="collapse">+</a>
                  </div>
                </div>
                </td>
              </tr>
              <tr>
            <td colspan="7" class="comments"> 
              <div class="accordion-body collapse" id="submitComment_{{ item.uid }}">
                <div class="accordion-inner no-border bot-border">
                  <form action="{{ url_for("submit_comment") }}" method="post">
                <div><input type="hidden" name="parent_uid" value="{{ item.uid }}" /></div> 
                <div><textarea rows="2" class="span12" name="content"></textarea>&nbsp;&nbsp;<button type="submit" class="btn btn-mini">Submit</button></div>
                  </form>
                </div>
              </div>
            </td>
              </tr>	      
              <!-- Comment Drop -->
              <tr>
                  <td colspan="7" class="comments"> 
                <div class="accordion-body collapse {{ item.show_comments }}" id="commentDrop{{ item.uid }}">
                  <div class="accordion-inner no-border bot-border">
                  {% for i in item.comments %}
                <blockquote>
                  <p style="font-size: 12px">{{ i.content }}</p>
                  <small>by <cite title="Source Title">{{i.username}} {% if i.time %} - {{i.time}} {% endif %}</cite></small>
                </blockquote>
                <hr>
                  {% endfor %}
                  </div>
                </div>
              </td>
              </tr>
              <!-- END Comment Drop -->
            </div> <!-- end accordian -->
     {% endfor %}
			</table>
{% endif %}     

    <div class="pagination pagination-mini pull-right"> 
        <ul id="pages" style="vertical-align:middle;">
        {% if num_pages %}
            {% for cnt in range(0,num_pages) %}
                {% if (loop.index==current_page) %}
                	{% if wf_name %}
						<li class="disabled"><a href="/home?wf_name={{ wf_name }}&range={{loop.index0*rpp+1}},{{loop.index0*rpp+rpp}}&r={{rpp}}&p={{loop.index}}">{{loop.index}}</a></li>
                    {% else %}
                    	<li class="disabled"><a href="/home?range={{loop.index0*rpp+1}},{{loop.index0*rpp+rpp}}&r={{rpp}}&p={{loop.index}}">{{loop.index}}</a></li>
                    {% endif %}
                {% else %}
                	{% if wf_name %}
	                    <li><a href="/home?wf_name={{ wf_name }}&range={{loop.index0*rpp+1}},{{loop.index0*rpp+rpp}}&r={{rpp}}&p={{loop.index}}">{{loop.index}}</a></li>
                    {% else %}
                    	<li><a href="/home?range={{loop.index0*rpp+1}},{{loop.index0*rpp+rpp}}&r={{rpp}}&p={{loop.index}}">{{loop.index}}</a></li>
                    {% endif %}
                {% endif %}                    
            {% endfor %}
        {% endif %}
        </ul>
        &nbsp;<span class="muted"><em><small>{{ num_wf }} workflows</small></em></span>
    </div>
    </div>
    </div> <!-- end row fluid -->
</div>
{% endblock %}