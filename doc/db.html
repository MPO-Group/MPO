
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module db</title>
<meta charset="utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong>db</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/Users/jwright/Codes/MPO/db/db.py">/Users/jwright/Codes/MPO/db/db.py</a></font></td></tr></table>
    <p><tt>#&nbsp;file&nbsp;:&nbsp;db.py</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="datetime.html">datetime</a><br>
<a href="simplejson.html">simplejson</a><br>
<a href="os.html">os</a><br>
</td><td width="25%" valign=top><a href="sqlalchemy.pool.html">sqlalchemy.pool</a><br>
<a href="psycopg2.html">psycopg2</a><br>
<a href="psycopg2.extras.html">psycopg2.extras</a><br>
</td><td width="25%" valign=top><a href="sys.html">sys</a><br>
<a href="textwrap.html">textwrap</a><br>
<a href="uuid.html">uuid</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-addCollection"><strong>addCollection</strong></a>(request, dn)</dt></dl>
 <dl><dt><a name="-addMetadata"><strong>addMetadata</strong></a>(json_request, dn)</dt></dl>
 <dl><dt><a name="-addOntologyClass"><strong>addOntologyClass</strong></a>(json_request, dn)</dt></dl>
 <dl><dt><a name="-addOntologyInstance"><strong>addOntologyInstance</strong></a>(json_request, dn)</dt></dl>
 <dl><dt><a name="-addRecord"><strong>addRecord</strong></a>(table, request, dn)</dt></dl>
 <dl><dt><a name="-addUser"><strong>addUser</strong></a>(json_request, submitter_dn)</dt></dl>
 <dl><dt><a name="-addWorkflow"><strong>addWorkflow</strong></a>(request, dn)</dt></dl>
 <dl><dt><a name="-checkAccess"><strong>checkAccess</strong></a>(dn, read<font color="#909090">=False</font>, write<font color="#909090">=False</font>)</dt></dl>
 <dl><dt><a name="-deleteOntologyTerms"><strong>deleteOntologyTerms</strong></a>(queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt><dd><tt>Given&nbsp;a&nbsp;record&nbsp;id&nbsp;delete&nbsp;the&nbsp;record&nbsp;from&nbsp;the&nbsp;db.</tt></dd></dl>
 <dl><dt><a name="-echo"><strong>echo</strong></a>(table, queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt><dd><tt>Dummy&nbsp;function&nbsp;to&nbsp;test&nbsp;route&nbsp;and&nbsp;api&nbsp;method&nbsp;construction</tt></dd></dl>
 <dl><dt><a name="-getOntologyTermTree"><strong>getOntologyTermTree</strong></a>(id<font color="#909090">='0'</font>, dn<font color="#909090">=None</font>)</dt><dd><tt>Constructs&nbsp;a&nbsp;tree&nbsp;from&nbsp;the&nbsp;ontology&nbsp;terms&nbsp;and&nbsp;returns<br>
structure&nbsp;suitable&nbsp;for&nbsp;parsing&nbsp;into&nbsp;graph&nbsp;or&nbsp;menu.<br>
Return&nbsp;is&nbsp;as&nbsp;a&nbsp;python&nbsp;dictionary&nbsp;(not&nbsp;JSON).</tt></dd></dl>
 <dl><dt><a name="-getRecord"><strong>getRecord</strong></a>(table, queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt><dd><tt>Generic&nbsp;record&nbsp;retrieval.&nbsp;Handles&nbsp;GET&nbsp;requests&nbsp;for&nbsp;all&nbsp;tables.<br>
Use&nbsp;as&nbsp;a&nbsp;template&nbsp;for&nbsp;route&nbsp;specific&nbsp;behavior.<br>
&nbsp;<br>
Retrieve&nbsp;a&nbsp;record&nbsp;based&nbsp;on&nbsp;join&nbsp;of&nbsp;restrictions&nbsp;in&nbsp;query&nbsp;arguments.<br>
To&nbsp;get&nbsp;a&nbsp;specific&nbsp;record,&nbsp;call&nbsp;with&nbsp;{'uid':id}.<br>
id&nbsp;overrides&nbsp;any&nbsp;query&nbsp;arguments&nbsp;since&nbsp;it&nbsp;specifies&nbsp;an&nbsp;exact&nbsp;record.&nbsp;You&nbsp;can&nbsp;get&nbsp;an&nbsp;empty<br>
replay&nbsp;with&nbsp;conflicting&nbsp;restrictions&nbsp;in&nbsp;queryargs.&nbsp;This&nbsp;function&nbsp;should&nbsp;be&nbsp;called&nbsp;with&nbsp;either<br>
id&nbsp;or&nbsp;queryarg&nbsp;arguments.</tt></dd></dl>
 <dl><dt><a name="-getRecordTable"><strong>getRecordTable</strong></a>(id, dn<font color="#909090">=None</font>)</dt><dd><tt>Given&nbsp;a&nbsp;record&nbsp;id&nbsp;return&nbsp;the&nbsp;table&nbsp;that&nbsp;record&nbsp;is&nbsp;in.</tt></dd></dl>
 <dl><dt><a name="-getTreePath"><strong>getTreePath</strong></a>(bottom, top)</dt></dl>
 <dl><dt><a name="-getUser"><strong>getUser</strong></a>(queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt></dl>
 <dl><dt><a name="-getWorkflow"><strong>getWorkflow</strong></a>(queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt><dd><tt>Processes&nbsp;the&nbsp;/workflow&nbsp;route.&nbsp;Handles&nbsp;get&nbsp;query&nbsp;arguments.</tt></dd></dl>
 <dl><dt><a name="-getWorkflowComments"><strong>getWorkflowComments</strong></a>(id, queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt></dl>
 <dl><dt><a name="-getWorkflowCompositeID"><strong>getWorkflowCompositeID</strong></a>(id, dn<font color="#909090">=None</font>)</dt><dd><tt>Returns&nbsp;composite&nbsp;id&nbsp;of&nbsp;the&nbsp;form&nbsp;user/workflow_name/composite_seq</tt></dd></dl>
 <dl><dt><a name="-getWorkflowElements"><strong>getWorkflowElements</strong></a>(id, queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt><dd><tt>Returns&nbsp;datastructure&nbsp;{connectivity:&nbsp;[{parent_uid:,&nbsp;parent_type:,&nbsp;child_uid:,&nbsp;child_type:}...&nbsp;],<br>
nodes:&nbsp;[{type:,&nbsp;name:,&nbsp;time:}...&nbsp;]&nbsp;}<br>
That&nbsp;describes&nbsp;the&nbsp;workflow&nbsp;as&nbsp;a&nbsp;complete&nbsp;DAG.</tt></dd></dl>
 <dl><dt><a name="-getWorkflowType"><strong>getWorkflowType</strong></a>(id, queryargs<font color="#909090">={}</font>, dn<font color="#909090">=None</font>)</dt></dl>
 <dl><dt><a name="-get_conn"><strong>get_conn</strong></a>()</dt></dl>
 <dl><dt><a name="-init"><strong>init</strong></a>(conn_str)</dt></dl>
 <dl><dt><a name="-processArgument"><strong>processArgument</strong></a>(a)</dt><dd><tt>Handle&nbsp;arguments&nbsp;in&nbsp;GET&nbsp;queries.&nbsp;If&nbsp;in&nbsp;double&nbsp;quotes,&nbsp;strip&nbsp;quotes&nbsp;and&nbsp;pass&nbsp;as&nbsp;literal&nbsp;search.<br>
Otherwise&nbsp;interpret&nbsp;possible&nbsp;wildcards.&nbsp;Spaces&nbsp;between&nbsp;words&nbsp;are&nbsp;treated&nbsp;as&nbsp;wildcards.</tt></dd></dl>
 <dl><dt><a name="-validReader"><strong>validReader</strong></a>(dn)</dt></dl>
 <dl><dt><a name="-validUser"><strong>validUser</strong></a>(dn)</dt></dl>
 <dl><dt><a name="-validWriter"><strong>validWriter</strong></a>(dn)</dt></dl>
</td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#55aa55">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Data</strong></big></font></td></tr>
    
<tr><td bgcolor="#55aa55"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><strong>conn_string</strong> = ''<br>
<strong>dbdebug</strong> = False<br>
<strong>mypool</strong> = None<br>
<strong>query_map</strong> = {'activity': {'description': 'description', 'end': 'end_time', 'name': 'name', 'start': 'start_time', 'status': 'completion_status', 'time': 'creation_time', 'uid': 'a_guid', 'uri': 'uri', 'user_uid': 'u_guid', 'work_uid': 'w_guid'}, 'activity_short': {'w': 'w_guid'}, 'collection': {'description': 'description', 'name': 'name', 'time': 'creation_time', 'uid': 'c_guid', 'user_uid': 'u_guid'}, 'collection_elements': {'parent_uid': 'c_guid', 'time': 'creation_time', 'uid': 'e_guid', 'user_uid': 'u_guid'}, 'comment': {'content': 'content', 'parent_uid': 'parent_GUID', 'ptype': 'parent_type', 'time': 'creation_time', 'type': 'comment_type', 'uid': 'cm_guid', 'user_uid': 'u_guid'}, 'dataobject': {'description': 'description', 'name': 'name', 'source_uid': 'source_guid', 'time': 'creation_time', 'uid': 'do_guid', 'uri': 'uri', 'user_uid': 'u_guid'}, 'dataobject_instance': {'do_uid': 'do_guid', 'time': 'creation_time', 'uid': 'doi_guid', 'user_uid': 'u_guid', 'work_uid': 'w_guid'}, 'dataobject_instance_short': {'w': 'w_guid'}, 'metadata': {'key': 'name', 'key_uid': 'type', 'parent_type': 'parent_type', 'parent_uid': 'parent_guid', 'time': 'creation_time', 'uid': 'md_guid', 'user_uid': 'u_guid', 'value': 'value'}, 'metadata_short': {'c': 'creation_time', 'n': 'name', 't': 'type', 'v': 'value'}, ...}</td></tr></table>
</body></html>